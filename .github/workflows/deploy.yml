name: Deploy SfOnBaseBridge to BTP CF

on:
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
    # -------------------------------
    # Checkout Code
    # -------------------------------
    - name: Checkout code
      uses: actions/checkout@v3

    # -------------------------------
    # Setup .NET
    # -------------------------------
    - name: Setup .NET
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: "8.0.x"

    # -------------------------------
    # Install Cloud Foundry CLI
    # -------------------------------
    - name: Install Cloud Foundry CLI (robust)
      run: |
        echo "Downloading CF CLI..."
        wget -qO cf.tgz "https://packages.cloudfoundry.org/stable?release=linux64-binary&source=github"

        echo "Extracting CF CLI..."
        tar -xzf cf.tgz

        echo "Searching for CF binary..."
        BIN=$(find . -maxdepth 3 -type f -name 'cf' -o -name 'cf8' -o -name 'cf7' | head -n 1)

        if [ -z "$BIN" ]; then
          echo "ERROR: CF CLI binary not found!"
          echo "Directory listing for debugging:"
          ls -R .
          exit 1
        fi

        ec
